---
title: 图像处理类
date: 2007-11-01 14:26:00
tags: 
categories: 
---
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)using System;  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)using
System.Drawing;  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)using
System.Drawing.Imaging;  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)using
System.Drawing.Drawing2D;  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)public class
Consts  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif)![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    //
grayscale values, these provide a better result then the weights  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    //
defined by the NTSC (North America Television Standards Committee)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    //
which are 0.299, 0.587, 0.114  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float GrayRed = 0.3086F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float GrayGreen = 0.6094F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float GrayBlue = 0.082F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    //
sepia values  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float SepiaRed = 0.2F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float SepiaGreen = 0.14F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float SepiaBlue = 0.08F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//resize quality  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const System.Drawing.Drawing2D.InterpolationMode ResizeQuality =
System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif)}  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)public class
GDI  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif)![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
enum Dimensions  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Width,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Height  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
enum AnchorPosition  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Top,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Center,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bottom,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Left,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Right  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap ScaleByPercent(Image imgPhoto, int Percent)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = ((float)Percent / 100);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap ReSize(Image imgPhoto, int Size, Dimensions Dimension, out float
percent)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
switch (Dimension)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case Dimensions.Width:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = ((float)Size / (float)sourceWidth);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
default:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = ((float)Size / (float)sourceHeight);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
percent = nPercent;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap ReSize(Image imgPhoto, int Size, Dimensions Dimension)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
switch (Dimension)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case Dimensions.Width:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = ((float)Size / (float)sourceWidth);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
default:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = ((float)Size / (float)sourceHeight);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap ReSize(Image imgPhoto, float percent)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = percent;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap FixedSize(Image imgPhoto, int Width, int Height)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercentW = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercentH = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercentW = ((float)Width / (float)sourceWidth);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercentH = ((float)Height / (float)sourceHeight);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//if we have to pad the height pad both the top and the bottom  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//with the difference between the scaled height and the desired height  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        if
(nPercentH < nPercentW)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = nPercentH;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX = (int)((Width - (sourceWidth * nPercent)) / 2);  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
else  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = nPercentW;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destY = (int)((Height - (sourceHeight * nPercent)) / 2);  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(Width, Height, PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Clear(Color.Black);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap Crop(Image imgPhoto, int Width, int Height, AnchorPosition
Anchor)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercentW = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercentH = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercentW = ((float)Width / (float)sourceWidth);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercentH = ((float)Height / (float)sourceHeight);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        if
(nPercentH < nPercentW)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = nPercentW;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
switch (Anchor)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case AnchorPosition.Top:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case AnchorPosition.Bottom:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destY = (int)(Height - (sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
default:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destY = (int)((Height - (sourceHeight * nPercent)) / 2);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
else  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = nPercentH;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
switch (Anchor)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case AnchorPosition.Left:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case AnchorPosition.Right:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX = (int)(Width - (sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
default:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX = (int)((Width - (sourceWidth * nPercent)) / 2);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(Width, Height, PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap Croping(Image imgPhoto, Rectangle rect)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        if
(rect.X < 0)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX = -rect.X;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        if
(rect.Y < 0)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destY = -rect.Y;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destWidth = rect.Width + destX;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destHeight = rect.Height + destY;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto, new Rectangle(0, 0, destWidth, destHeight), rect,
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap makenew(Image imgPhoto, int x, int y, int w, int h)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
ww = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
hh = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(w, h, PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(x, y, ww, hh), new Rectangle(0, 0, imgPhoto.Width,
imgPhoto.Height),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
/**//// <summary>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
mask done  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
</summary>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="image">剪裁图像</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="imagebak">全图像</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="x">横向边距</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="y">竖向边距</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="w">色罩宽</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="h">色罩高</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="pos1">全图像在扫描图像中的起点</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<returns></returns>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<summary>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
边缘拉伸处理  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
</summary>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="imgPhoto">图像</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="dir">1:up ,2:down ,3:left ,4:right</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="where">位置</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
/// <returns></returns>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap streth(Image imgPhoto, int dir, int where)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
ww = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
hh = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = (Bitmap)imgPhoto.Clone();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
switch (dir)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case 1://up  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, 0, ww, where), new Rectangle(0, where, ww, 10),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case 2://down  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, where, ww, hh - where), new Rectangle(0, where - 10, ww, 10),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case 3://left  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, 0, where, hh), new Rectangle(where, 0, 10, hh),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case 4://right  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(where, 0, ww - where, hh), new Rectangle(where - 10, 0, 10, hh),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap hsi(Image imgPhoto)//,int h,int s,int i)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(imgPhoto.Width, imgPhoto.Height,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ColorMatrix myColorMatrix = new ColorMatrix();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myColorMatrix.Matrix00 = 1.75f; // Red  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myColorMatrix.Matrix11 = 1.00f; // Green  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myColorMatrix.Matrix22 = 1.00f; // Blue  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myColorMatrix.Matrix33 = 1.00f; // alpha  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myColorMatrix.Matrix44 = 1.00f; // w  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        //
Create an ImageAttributes object and set the color matrix.  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes imageAttr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
imageAttr.SetColorMatrix(myColorMatrix);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, 0, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
0, 0, sourceWidth, sourceHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, imageAttr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap rota(Image imgPhoto, float angle)//,int h,int s,int i)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destWidth = sourceWidth;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destHeight = sourceHeight;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(imgPhoto.Width, imgPhoto.Height,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Matrix myMatrix = new Matrix();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myMatrix.RotateAt(angle, new Point((int)(sourceWidth / 2), (int)(sourceHeight
/ 2)), MatrixOrder.Append);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Transform = myMatrix;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//g.Clip=new Region(new
Rectangle(this.croping.X,this.croping.Y,this.croping.Width+1,this.croping.Height+1));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//g.Transform = myMatrix2;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//g.DrawImage(image,rectd,rects, GraphicsUnit.Pixel );  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//g.Transform = myMatrix;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, 0, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, 0, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    //
return matrix for the specified saturation  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap satuation(Image imgPhoto, float percent)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//set the saturation by scaling the red, green and blue values  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        //a
value of 0 is grayscale, 1.0 is the orginial (no change) and  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//above 2.0 starts to look unnatural  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//calculate the scaling offset to apply to the red, green and blue colors  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float v;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        if
(percent > 0)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//range from 1 (no change) to 2.5 (a lot of saturation)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
v = 1.0F + (0.015F * percent);  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
else  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
// range from 0.25 (almost grayscale) to 1 (no change)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
v = 1.0F - (0.0075F * -percent);  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float red = (1.0F - v) * Consts.GrayRed;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float green = (1.0F - v) * Consts.GrayGreen;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float blue = (1.0F - v) * Consts.GrayBlue;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ColorMatrix cm = new ColorMatrix();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix00 = red + v;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix01 = red;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix02 = red;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix03 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix04 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix10 = green;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix11 = green + v;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix12 = green;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix13 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix14 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix20 = blue;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix21 = blue;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix22 = blue + v;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix23 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix24 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix30 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix31 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix32 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix33 = 1;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix34 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix40 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix41 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix42 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix43 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix44 = 1;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes attr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
attr.SetColorMatrix(cm);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX, destY, destWidth, destHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, attr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap gamma(Image imgPhoto, float percent)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float pp = percent / 100.0f + 1;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes attr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
attr.SetGamma(pp, ColorAdjustType.Bitmap);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX, destY, destWidth, destHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, attr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap grayscale(Image imgPhoto)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
ColorMatrix cm = new ColorMatrix(new
float[][]![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0.5f,0.5f,0.5f,0,0},  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0.5f,0.5f,0.5f,0,0},  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0.5f,0.5f,0.5f,0,0},  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0,0,0,1,0,0},  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0,0,0,0,1,0},  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0,0,0,0,0,1}});  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
/**//*  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ColorMatrix cm = new ColorMatrix(new float[][]{  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ Consts.GrayRed , Consts.GrayRed ,Consts.GrayRed , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ Consts.GrayGreen , Consts.GrayBlue , Consts.GrayBlue , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ Consts.GrayBlue , Consts.GrayBlue , Consts.GrayBlue , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ 0 ,0 , 0 , 1 , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ 0 ,0 , 0 , 0 , 1 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ 0 ,0 , 0 , 0 , 0 , 1 }});  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
*/  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes attr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
attr.SetColorMatrix(cm);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX, destY, destWidth, destHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, attr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap contrast(Image imgPhoto, float contrast)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float t = 0.5f * (1f - contrast);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
ColorMatrix cm = new ColorMatrix(new
float[][]![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ contrast , 0 , 0 , 0 ,
0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , contrast , 0 , 0 ,
0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , 0 , contrast , 0 ,
0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , 0 , 0        , 1 ,
0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ t , t , t        , 0 ,
1 }});  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes attr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
attr.SetColorMatrix(cm);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX, destY, destWidth, destHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, attr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap brightness(Image imgPhoto, float d)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
ColorMatrix cm = new ColorMatrix(new
float[][]![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 1 , 0 , 0 , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , 1 , 0 , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , 0 , 1 , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , 0 , 0 , 1 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ d , d , d , 0 , 1 }});  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes attr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
attr.SetColorMatrix(cm);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX, destY, destWidth, destHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, attr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif)}

---
title: 图像处理类
date: 2007-11-01 14:26:00
tags: 
categories: 
---
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)using System;  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)using
System.Drawing;  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)using
System.Drawing.Imaging;  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)using
System.Drawing.Drawing2D;  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)public class
Consts  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif)![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    //
grayscale values, these provide a better result then the weights  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    //
defined by the NTSC (North America Television Standards Committee)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    //
which are 0.299, 0.587, 0.114  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float GrayRed = 0.3086F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float GrayGreen = 0.6094F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float GrayBlue = 0.082F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    //
sepia values  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float SepiaRed = 0.2F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float SepiaGreen = 0.14F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const float SepiaBlue = 0.08F;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//resize quality  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
const System.Drawing.Drawing2D.InterpolationMode ResizeQuality =
System.Drawing.Drawing2D.InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif)}  
![](https://www.cnblogs.com/images/OutliningIndicators/None.gif)public class
GDI  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedBlock.gif)![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
enum Dimensions  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Width,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Height  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
enum AnchorPosition  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Top,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Center,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bottom,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Left,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Right  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap ScaleByPercent(Image imgPhoto, int Percent)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = ((float)Percent / 100);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap ReSize(Image imgPhoto, int Size, Dimensions Dimension, out float
percent)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
switch (Dimension)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case Dimensions.Width:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = ((float)Size / (float)sourceWidth);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
default:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = ((float)Size / (float)sourceHeight);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
percent = nPercent;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap ReSize(Image imgPhoto, int Size, Dimensions Dimension)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
switch (Dimension)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case Dimensions.Width:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = ((float)Size / (float)sourceWidth);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
default:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = ((float)Size / (float)sourceHeight);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap ReSize(Image imgPhoto, float percent)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = percent;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap FixedSize(Image imgPhoto, int Width, int Height)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercentW = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercentH = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercentW = ((float)Width / (float)sourceWidth);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercentH = ((float)Height / (float)sourceHeight);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//if we have to pad the height pad both the top and the bottom  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//with the difference between the scaled height and the desired height  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        if
(nPercentH < nPercentW)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = nPercentH;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX = (int)((Width - (sourceWidth * nPercent)) / 2);  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
else  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = nPercentW;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destY = (int)((Height - (sourceHeight * nPercent)) / 2);  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(Width, Height, PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Clear(Color.Black);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap Crop(Image imgPhoto, int Width, int Height, AnchorPosition
Anchor)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercent = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercentW = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float nPercentH = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercentW = ((float)Width / (float)sourceWidth);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercentH = ((float)Height / (float)sourceHeight);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        if
(nPercentH < nPercentW)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = nPercentW;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
switch (Anchor)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case AnchorPosition.Top:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case AnchorPosition.Bottom:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destY = (int)(Height - (sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
default:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destY = (int)((Height - (sourceHeight * nPercent)) / 2);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
else  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
nPercent = nPercentH;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
switch (Anchor)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case AnchorPosition.Left:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case AnchorPosition.Right:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX = (int)(Width - (sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
default:  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX = (int)((Width - (sourceWidth * nPercent)) / 2);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = (int)Math.Ceiling((sourceWidth * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = (int)Math.Ceiling((sourceHeight * nPercent));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(Width, Height, PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(sourceX, sourceY, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap Croping(Image imgPhoto, Rectangle rect)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        if
(rect.X < 0)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX = -rect.X;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        if
(rect.Y < 0)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destY = -rect.Y;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destWidth = rect.Width + destX;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destHeight = rect.Height + destY;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto, new Rectangle(0, 0, destWidth, destHeight), rect,
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap makenew(Image imgPhoto, int x, int y, int w, int h)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
ww = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
hh = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(w, h, PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(x, y, ww, hh), new Rectangle(0, 0, imgPhoto.Width,
imgPhoto.Height),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
/**//// <summary>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
mask done  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
</summary>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="image">剪裁图像</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="imagebak">全图像</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="x">横向边距</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="y">竖向边距</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="w">色罩宽</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="h">色罩高</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="pos1">全图像在扫描图像中的起点</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<returns></returns>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<summary>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
边缘拉伸处理  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
</summary>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="imgPhoto">图像</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="dir">1:up ,2:down ,3:left ,4:right</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    ///
<param name="where">位置</param>  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
/// <returns></returns>  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap streth(Image imgPhoto, int dir, int where)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
ww = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
hh = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = (Bitmap)imgPhoto.Clone();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
switch (dir)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case 1://up  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, 0, ww, where), new Rectangle(0, where, ww, 10),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case 2://down  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, where, ww, hh - where), new Rectangle(0, where - 10, ww, 10),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case 3://left  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, 0, where, hh), new Rectangle(where, 0, 10, hh),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
case 4://right  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(where, 0, ww - where, hh), new Rectangle(where - 10, 0, 10, hh),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
break;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap hsi(Image imgPhoto)//,int h,int s,int i)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(imgPhoto.Width, imgPhoto.Height,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.Bicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ColorMatrix myColorMatrix = new ColorMatrix();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myColorMatrix.Matrix00 = 1.75f; // Red  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myColorMatrix.Matrix11 = 1.00f; // Green  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myColorMatrix.Matrix22 = 1.00f; // Blue  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myColorMatrix.Matrix33 = 1.00f; // alpha  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myColorMatrix.Matrix44 = 1.00f; // w  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        //
Create an ImageAttributes object and set the color matrix.  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes imageAttr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
imageAttr.SetColorMatrix(myColorMatrix);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, 0, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
0, 0, sourceWidth, sourceHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, imageAttr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap rota(Image imgPhoto, float angle)//,int h,int s,int i)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
sourceHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destWidth = sourceWidth;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destHeight = sourceHeight;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(imgPhoto.Width, imgPhoto.Height,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Matrix myMatrix = new Matrix();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
myMatrix.RotateAt(angle, new Point((int)(sourceWidth / 2), (int)(sourceHeight
/ 2)), MatrixOrder.Append);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Transform = myMatrix;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//g.Clip=new Region(new
Rectangle(this.croping.X,this.croping.Y,this.croping.Width+1,this.croping.Height+1));  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//g.Transform = myMatrix2;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//g.DrawImage(image,rectd,rects, GraphicsUnit.Pixel );  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//g.Transform = myMatrix;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, 0, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(0, 0, sourceWidth, sourceHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    //
return matrix for the specified saturation  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap satuation(Image imgPhoto, float percent)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//set the saturation by scaling the red, green and blue values  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        //a
value of 0 is grayscale, 1.0 is the orginial (no change) and  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//above 2.0 starts to look unnatural  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//calculate the scaling offset to apply to the red, green and blue colors  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float v;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        if
(percent > 0)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
//range from 1 (no change) to 2.5 (a lot of saturation)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
v = 1.0F + (0.015F * percent);  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
else  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
// range from 0.25 (almost grayscale) to 1 (no change)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
v = 1.0F - (0.0075F * -percent);  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float red = (1.0F - v) * Consts.GrayRed;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float green = (1.0F - v) * Consts.GrayGreen;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float blue = (1.0F - v) * Consts.GrayBlue;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ColorMatrix cm = new ColorMatrix();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix00 = red + v;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix01 = red;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix02 = red;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix03 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix04 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix10 = green;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix11 = green + v;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix12 = green;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix13 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix14 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix20 = blue;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix21 = blue;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix22 = blue + v;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix23 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix24 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix30 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix31 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix32 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix33 = 1;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix34 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix40 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix41 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix42 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix43 = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
cm.Matrix44 = 1;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes attr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
attr.SetColorMatrix(cm);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX, destY, destWidth, destHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, attr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap gamma(Image imgPhoto, float percent)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float pp = percent / 100.0f + 1;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes attr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
attr.SetGamma(pp, ColorAdjustType.Bitmap);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX, destY, destWidth, destHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, attr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap grayscale(Image imgPhoto)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
ColorMatrix cm = new ColorMatrix(new
float[][]![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0.5f,0.5f,0.5f,0,0},  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0.5f,0.5f,0.5f,0,0},  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0.5f,0.5f,0.5f,0,0},  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0,0,0,1,0,0},  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0,0,0,0,1,0},  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){0,0,0,0,0,1}});  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
/**//*  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ColorMatrix cm = new ColorMatrix(new float[][]{  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ Consts.GrayRed , Consts.GrayRed ,Consts.GrayRed , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ Consts.GrayGreen , Consts.GrayBlue , Consts.GrayBlue , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ Consts.GrayBlue , Consts.GrayBlue , Consts.GrayBlue , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ 0 ,0 , 0 , 1 , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ 0 ,0 , 0 , 0 , 1 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new float[]{ 0 ,0 , 0 , 0 , 0 , 1 }});  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
*/  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes attr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
attr.SetColorMatrix(cm);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX, destY, destWidth, destHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, attr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap contrast(Image imgPhoto, float contrast)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
float t = 0.5f * (1f - contrast);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
ColorMatrix cm = new ColorMatrix(new
float[][]![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ contrast , 0 , 0 , 0 ,
0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , contrast , 0 , 0 ,
0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , 0 , contrast , 0 ,
0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , 0 , 0        , 1 ,
0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ t , t , t        , 0 ,
1 }});  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes attr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
attr.SetColorMatrix(cm);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX, destY, destWidth, destHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, attr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)    public
static Bitmap brightness(Image imgPhoto, float d)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destX = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destY = 0;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destWidth = imgPhoto.Width;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)        int
destHeight = imgPhoto.Height;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Bitmap bmPhoto = new Bitmap(destWidth, destHeight,
PixelFormat.Format24bppRgb);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
bmPhoto.SetResolution(imgPhoto.HorizontalResolution,
imgPhoto.VerticalResolution);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
Graphics grPhoto = Graphics.FromImage(bmPhoto);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.InterpolationMode = InterpolationMode.HighQualityBicubic;  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
ColorMatrix cm = new ColorMatrix(new
float[][]![](http://www.cnblogs.com/Images/dot.gif){  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 1 , 0 , 0 , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , 1 , 0 , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , 0 , 1 , 0 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ 0 , 0 , 0 , 1 , 0 },  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockStart.gif)![](https://www.cnblogs.com/images/OutliningIndicators/ContractedSubBlock.gif)
new float[]![](http://www.cnblogs.com/Images/dot.gif){ d , d , d , 0 , 1 }});  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
ImageAttributes attr = new ImageAttributes();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
attr.SetColorMatrix(cm);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.DrawImage(imgPhoto,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
new Rectangle(destX, destY, destWidth, destHeight),  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
destX, destY, destWidth, destHeight,  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
GraphicsUnit.Pixel, attr);  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
grPhoto.Dispose();  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)
return bmPhoto;  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedSubBlockEnd.gif)
}  
![](https://www.cnblogs.com/images/OutliningIndicators/InBlock.gif)  
![](https://www.cnblogs.com/images/OutliningIndicators/ExpandedBlockEnd.gif)}

